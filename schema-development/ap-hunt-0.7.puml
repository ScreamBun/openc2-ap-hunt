@startuml
' package: https://praxiseng.com/threat-hunter-9001
' version: 0-wd01
' title: Threat Hunting Profile
' description: Data definitions for Threat Hunting (TH) functions
' exports: ['OpenC2-Command', 'OpenC2-Response', 'SCO']
' config: {'$MaxBinary': 5555, '$MaxString': 5555, '$MaxElements': 555, '$Sys': '$', '$TypeName': '^[A-Za-z][-:_A-Za-z0-9]{0,63}$', '$FieldName': '^[A-Za-z][-:_A-Za-z0-9]{0,63}$', '$NSID': '^[A-Za-z][A-Za-z0-9]{0,7}$'}

' !theme spacelab
hide empty members
hide circle

class "Target" as n3 <<Choice>>
  n3 : 9 features : Features
  n3 : 1036 th/ : AP-Target
class "Args" as n4 <<Map>>
  n4 : 1 start_time : Date-Time [0..1]
  n4 : 2 stop_time : Date-Time [0..1]
  n4 : 3 duration : Duration [0..1]
  n4 : 4 response_requested : Response-Type [0..1]
  n4 : 1036 th : AP-Args [0..1]
class "Actuator" as n5 <<Choice>>
  n5 : 1036 th/ : AP-Specifiers
class "Results" as n6 <<Map>>
  n6 : 1 versions : Version unique [0..10]
  n6 : 2 profiles : Nsid unique [0..*]
  n6 : 3 pairs : Pairs [0..1]
  n6 : 4 rate_limit : Number{0.0..*} [0..1]
  n6 : 5 args : ArrayOf{String} [0..1]
  n6 : 1036 th/ : AP-Results [0..1]
class "AP-Target" as n8 <<Choice>>
  n8 : 1 hunt : String
  n8 : 2 huntflows : Huntflow-Specifiers
  n8 : 3 datasources : String [0..1]
class "AP-Args" as n9 <<Map>>
  n9 : 1 huntargs : Huntargs
class "Huntargs" as n10 <<Record>>
  n10 : 1 string_args : ArrayOf{String} [0..1]
  n10 : 2 integer_args : ArrayOf{Integer} [0..1]
  n10 : 3 typed_args : Typed-Arguments [0..1]
  n10 : 4 native_oc2 : OC2-Data [0..1]
  n10 : 5 stix : STIX-Cybersecurity-Observables [0..1]
  n10 : 6 stix_extensions : String [0..1]
  n10 : 7 timeranges : Timeranges [0..1]
  n10 : 8 datasources : Datasource-Array [0..1]
class "OC2-Data" as n11 <<ArrayOf>>
class "Language-Spec-Types" as n12 <<Record>>
  n12 : 1 artifact : Artifact [0..1]
  n12 : 2 device : Device [0..1]
  n12 : 3 domain_name : Domain-Name [0..1]
  n12 : 4 email-address : Email-Addr [0..1]
  n12 : 5 file : File [0..1]
  n12 : 6 hashes : Hashes [0..1]
  n12 : 7 hostname : Hostname [0..1]
  n12 : 8 idn_domain_name : IDN-Domain-Name [0..1]
  n12 : 9 idn_email_address : IDN-Email-Addr [0..1]
  n12 : 10 ipv4_address : IPv4-Addr [0..1]
  n12 : 11 ipv6_address : IPv6-Addr [0..1]
  n12 : 12 ipv4_network : IPv4-Net [0..1]
  n12 : 13 ipv6_network : IPv6-Net [0..1]
  n12 : 14 ipv4_connection : IPv4-Connection [0..1]
  n12 : 15 ipv6_connection : IPv6-Connection [0..1]
  n12 : 16 iri : IRI [0..1]
  n12 : 17 mac_address : MAC-Addr [0..1]
  n12 : 18 port : Port [0..1]
  n12 : 19 process : Process [0..1]
  n12 : 20 uri : URI [0..1]
class "Artifact" as n13 <<Record>>
  n13 : 1 mime_type : String [0..1]
  n13 : 2 payload : Payload [0..1]
  n13 : 3 hashes : Hashes [0..1]
class "Device" as n14 <<Map>>
  n14 : 1 hostname : Hostname [0..1]
  n14 : 2 idn_hostname : IDN-Hostname [0..1]
  n14 : 3 device_id : String [0..1]
class "File" as n17 <<Map>>
  n17 : 1 name : String [0..1]
  n17 : 2 path : String [0..1]
  n17 : 3 hashes : Hashes [0..1]
class "IPv4-Net" as n20 <<Array>>
  n20 : 1  : IPv4-Addr
  n20 : 2  : Integer [0..1]
class "IPv4-Connection" as n21 <<Record>>
  n21 : 1 src_addr : IPv4-Net [0..1]
  n21 : 2 src_port : Port [0..1]
  n21 : 3 dst_addr : IPv4-Net [0..1]
  n21 : 4 dst_port : Port [0..1]
  n21 : 5 protocol : L4-Protocol [0..1]
class "IPv6-Net" as n22 <<Array>>
  n22 : 1  : IPv6-Addr
  n22 : 2  : Integer [0..1]
class "IPv6-Connection" as n23 <<Record>>
  n23 : 1 src_addr : IPv6-Net [0..1]
  n23 : 2 src_port : Port [0..1]
  n23 : 3 dst_addr : IPv6-Net [0..1]
  n23 : 4 dst_port : Port [0..1]
  n23 : 5 protocol : L4-Protocol [0..1]
class "Process" as n26 <<Map>>
  n26 : 1 pid : Key{Integer{0..*}} [0..1]
  n26 : 2 name : String [0..1]
  n26 : 3 cwd : String [0..1]
  n26 : 4 executable : File [0..1]
  n26 : 5 parent : Link{Process} [0..1]
  n26 : 6 command_line : String [0..1]
class "Hashes" as n28 <<Map>>
  n28 : 1 md5 : Binary /x [0..1]
  n28 : 2 sha1 : Binary /x [0..1]
  n28 : 3 sha256 : Binary /x [0..1]
class "AP-Specifiers" as n34 <<Map>>
class "Huntflow-Specifiers" as n35 <<Map>>
  n35 : 1 path : String [0..1]
  n35 : 2 tags : Tags [0..1]
  n35 : 3 arg_types : Specified-Arg-Types [0..1]
  n35 : 4 arg_names : Specified-Arg-Names [0..1]
  n35 : 5 format_types : Return-Type [0..1]
  n35 : 6 return_format : Huntflow-Sections [0..1]
class "Specified-Arg-Types" as n36 <<ArrayOf>>
class "Specified-Arg-Names" as n37 <<ArrayOf>>
class "AP-Results" as n38 <<Map>>
  n38 : 1 huntflow_info : ArrayOf{Huntflow-Info} [0..1]
  n38 : 2 datasources : Datasource-Array [0..1]
  n38 : 3 inv_returns : Inv-Returns [0..1]
class "Inv-Returns" as n39 <<ArrayOf>>
class "Inv-Return" as n40 <<Record>>
  n40 : 1 string_returns : ArrayOf{String} [0..1]
  n40 : 2 stix_sco : STIX-Cybersecurity-Observables [0..1]
class "Timeranges" as n41 <<ArrayOf>>
class "Timerange" as n42 <<Choice>>
  n42 : 1 timerange_absolute : Timerange-Abs [0..1]
  n42 : 2 timerange_relative : Timerange-Rel [0..1]
class "Timerange-Abs" as n44 <<Record>>
  n44 : 1 hunt_start_time : timestamp
  n44 : 2 hunt_stop_time : timestamp
class "Timerange-Rel" as n45 <<Record>>
  n45 : 1 number : Integer
  n45 : 2 time_unit : Time-Unit
class "Return-Type" as n46 <<Record>>
  n46 : 1 var_name : Arg-Name
  n46 : 2 var_type : Arg-Type
class "Datasource" as n47 <<Record>>
  n47 : 1 ds_name : String
  n47 : 2 ds_tags : Tags [0..1]
class "Huntflow-Sections" as n48 <<ArrayOf>>
class "Huntflow-Info" as n50 <<Record>>
  n50 : 1 path : String [0..1]
  n50 : 2 uniqueId : Integer [0..1]
  n50 : 3 version : String [0..1]
  n50 : 4 args_required : Typed-Arguments [0..1]
  n50 : 5 expected_returns : Typed-Arguments [0..1]
  n50 : 6 script : String [0..1]
class "Datasource-Array" as n51 <<ArrayOf>>
class "Tags" as n52 <<ArrayOf>>
class "Typed-Arguments" as n53 <<MapOf>>
class "STIX-Cybersecurity-Observables" as n56 <<ArrayOf>>
class "SCO" as n57 <<Choice>>
  n57 : 1 Artifact : artifact
  n57 : 2 Autonomous-System : autonomous-system
  n57 : 3 Directory : directory
  n57 : 4 Domain-Name : domain-name
  n57 : 5 Email-Addr : email-addr
  n57 : 6 Email-Message : email-message
  n57 : 7 File : file
  n57 : 8 IPv4-Addr : ipv4-addr
  n57 : 9 IPv6-Addr : ipv6-addr
  n57 : 10 Mac-Addr : mac-addr
  n57 : 11 Mutex : mutex
  n57 : 12 Network-Traffic : network-traffic
  n57 : 13 Process : process
  n57 : 14 Software : software
  n57 : 15 URL : url
  n57 : 16 User-Account : user-account
  n57 : 17 Windows-Registry-Key : windows-registry-key
  n57 : 18 X509-Certificate : x509-certificate
@enduml